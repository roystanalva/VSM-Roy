const { BasePage } = require('./basePage');\n\nclass RegistrationPage extends BasePage {\n  constructor(page) {\n    super(page);\n    this.SIGNUP_BUTTON_SELECTOR = 'button:has-text(\"Sign Up\"), a:has-text(\"Register\"), [class*=\"signup-btn\"]';\n    this.NAME_INPUT_SELECTOR = 'input[placeholder*=\"name\" i], input[id*=\"name\"], #fullname, #firstname';\n    this.EMAIL_INPUT_SELECTOR = 'input[type=\"email\"], input[placeholder*=\"email\" i], #email';\n    this.PASSWORD_INPUT_SELECTOR = 'input[type=\"password\"], #password';\n    this.CONFIRM_PASSWORD_SELECTOR = 'input[placeholder*=\"confirm\" i], input[id*=\"confirm\"], #password-confirm';\n    this.TERMS_CHECKBOX_SELECTOR = 'input[type=\"checkbox\"][id*=\"terms\"], input[type=\"checkbox\"][class*=\"terms\"]';\n    this.SUBMIT_BUTTON_SELECTOR = 'button[type=\"submit\"]:has-text(\"Sign Up\"), button[type=\"submit\"]:has-text(\"Register\")';\n    this.SUCCESS_MESSAGE_SELECTOR = '[class*=\"success\"], [class*=\"congratulations\"]';\n    this.ERROR_MESSAGE_SELECTOR = '[class*=\"error\"], [class*=\"alert\"], .error-message';\n    this.REGISTRATION_FORM_SELECTOR = 'form[action*=\"register\"], [class*=\"registration-form\"], [class*=\"signup-form\"]';\n    this.LOGIN_LINK_SELECTOR = 'a:has-text(\"Log In\"), a:has-text(\"Already have an account\")';\n  }\n\n  async navigateToRegistration() {\n    if (await this.elementExists(this.SIGNUP_BUTTON_SELECTOR)) {\n      await this.click(this.SIGNUP_BUTTON_SELECTOR);\n      await this.waitForPageLoad();\n    }\n  }\n\n  async isRegistrationFormVisible() {\n    const formSelectors = [this.REGISTRATION_FORM_SELECTOR, 'form', '[class*=\"signup\"]', '[class*=\"register\"]'];\n    return await this.waitForAny(formSelectors, 2000);\n  }\n\n  async isSignupFormVisible() {\n    return await this.isRegistrationFormVisible();\n  }\n\n  async register(name, email, password) {\n    const nameSelectors = [this.NAME_INPUT_SELECTOR, 'input[placeholder*=\"name\"]', 'input[name=\"name\"]'];\n    const emailSelectors = [this.EMAIL_INPUT_SELECTOR, 'input[type=\"email\"]', 'input[name=\"email\"]'];\n    const passwordSelectors = [this.PASSWORD_INPUT_SELECTOR, 'input[type=\"password\"]', 'input[name=\"password\"]'];\n    const confirmSelectors = [this.CONFIRM_PASSWORD_SELECTOR, 'input[placeholder*=\"confirm\"]', 'input[name*=\"confirm\"]'];\n\n    await this.fillIfExists(nameSelectors, name);\n    await this.fillIfExists(emailSelectors, email);\n    await this.fillIfExists(passwordSelectors, password);\n    await this.fillIfExists(confirmSelectors, password);\n  }\n\n  async acceptTerms() {\n    if (await this.elementExists(this.TERMS_CHECKBOX_SELECTOR)) {\n      const isChecked = await this.page.evaluate((selector) => {\n        const el = document.querySelector(selector);\n        return el ? el.checked : false;\n      }, this.TERMS_CHECKBOX_SELECTOR);\n      if (!isChecked) {\n        await this.click(this.TERMS_CHECKBOX_SELECTOR);\n      }\n    }\n  }\n\n  async submitRegistration() {\n    if (await this.elementExists(this.SUBMIT_BUTTON_SELECTOR)) {\n      await this.click(this.SUBMIT_BUTTON_SELECTOR);\n      await this.waitForPageLoad();\n    }\n  }\n\n  async isSuccessMessageDisplayed() {\n    try {\n      await this.waitForElement(this.SUCCESS_MESSAGE_SELECTOR, 3000);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async getErrorMessage() {\n    if (await this.isElementVisible(this.ERROR_MESSAGE_SELECTOR)) {\n      return await this.getText(this.ERROR_MESSAGE_SELECTOR);\n    }\n    return '';\n  }\n\n  async isErrorDisplayed() {\n    return await this.isElementVisible(this.ERROR_MESSAGE_SELECTOR);\n  }\n\n  async clickLoginLink() {\n    if (await this.elementExists(this.LOGIN_LINK_SELECTOR)) {\n      await this.click(this.LOGIN_LINK_SELECTOR);\n      await this.waitForPageLoad();\n    }\n  }\n\n  async completeRegistration(name, email, password) {\n    await this.register(name, email, password);\n    await this.acceptTerms();\n    await this.submitRegistration();\n  }\n}\n\nmodule.exports = { RegistrationPage };