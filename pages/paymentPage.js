const { BasePage } = require('./basePage');\n\nclass PaymentPage extends BasePage {\n  constructor(page) {\n    super(page);\n    this.PAYMENT_BUTTON_SELECTOR = 'button:has-text(\"Pay\"), button:has-text(\"Checkout\"), [class*=\"payment-btn\"]';\n    this.CARD_NUMBER_SELECTOR = 'input[placeholder*=\"card\" i], input[id*=\"cardnumber\"], input[name=\"cardnumber\"]';\n    this.CARD_NAME_SELECTOR = 'input[placeholder*=\"name\" i], input[id*=\"cardname\"]';\n    this.EXPIRY_SELECTOR = 'input[placeholder*=\"expir\" i], input[id*=\"expiry\"]';\n    this.CVC_SELECTOR = 'input[placeholder*=\"cvc\" i], input[placeholder*=\"cvv\" i], input[id*=\"cvc\"]';\n    this.BILLING_ADDRESS_SELECTOR = 'input[placeholder*=\"address\" i]';\n    this.SUBMIT_PAYMENT_SELECTOR = 'button[type=\"submit\"]:has-text(\"Pay\"), button:has-text(\"Complete\")';\n    this.PRICE_SELECTOR = '[class*=\"price\"], [class*=\"total\"], .amount';\n    this.SUCCESS_MESSAGE_SELECTOR = '[class*=\"success\"], [class*=\"thank you\"]';\n    this.ERROR_MESSAGE_SELECTOR = '[class*=\"error\"], [class*=\"declined\"]';\n    this.PAYMENT_FORM_SELECTOR = 'form[action*=\"pay\"], [class*=\"payment-form\"], [class*=\"checkout-form\"]';\n    this.PROMO_CODE_SELECTOR = 'input[placeholder*=\"promo\" i], input[id*=\"coupon\"], input[id*=\"discount\"]';\n    this.APPLY_PROMO_SELECTOR = 'button:has-text(\"Apply\"), button:has-text(\"Redeem\")';\n  }\n\n  async isPaymentFormVisible() {\n    const formSelectors = [this.PAYMENT_FORM_SELECTOR, 'form', '[class*=\"payment\"]', '[class*=\"checkout\"]'];\n    return await this.waitForAny(formSelectors, 2000);\n  }\n\n  async getPrice() {\n    if (await this.isElementVisible(this.PRICE_SELECTOR)) {\n      return await this.getText(this.PRICE_SELECTOR);\n    }\n    return '';\n  }\n\n  async enterPaymentDetails(cardNumber, cardName, expiry, cvc) {\n    const cardSelectors = [this.CARD_NUMBER_SELECTOR, 'input[placeholder*=\"card\"]', 'input[name=\"card\"]'];\n    const nameSelectors = [this.CARD_NAME_SELECTOR, 'input[placeholder*=\"name\"]', 'input[name=\"name\"]'];\n    const expirySelectors = [this.EXPIRY_SELECTOR, 'input[placeholder*=\"expir\"]', 'input[name=\"expiry\"]'];\n    const cvcSelectors = [this.CVC_SELECTOR, 'input[placeholder*=\"cvv\"]', 'input[name=\"cvc\"]'];\n\n    await this.fillIfExists(cardSelectors, cardNumber);\n    await this.fillIfExists(nameSelectors, cardName);\n    await this.fillIfExists(expirySelectors, expiry);\n    await this.fillIfExists(cvcSelectors, cvc);\n  }\n\n  async enterBillingAddress(address) {\n    if (await this.isElementVisible(this.BILLING_ADDRESS_SELECTOR)) {\n      await this.fill(this.BILLING_ADDRESS_SELECTOR, address);\n    }\n  }\n\n  async applyPromoCode(promoCode) {\n    if (await this.isElementVisible(this.PROMO_CODE_SELECTOR)) {\n      await this.fill(this.PROMO_CODE_SELECTOR, promoCode);\n      if (await this.elementExists(this.APPLY_PROMO_SELECTOR)) {\n        await this.click(this.APPLY_PROMO_SELECTOR);\n        await this.page.waitForTimeout(500);\n      }\n    }\n  }\n\n  async submitPayment() {\n    if (await this.elementExists(this.SUBMIT_PAYMENT_SELECTOR)) {\n      await this.click(this.SUBMIT_PAYMENT_SELECTOR);\n      await this.waitForPageLoad();\n    }\n  }\n\n  async isPaymentSuccessful() {\n    return await this.isElementVisible(this.SUCCESS_MESSAGE_SELECTOR);\n  }\n\n  async getPaymentError() {\n    if (await this.isElementVisible(this.ERROR_MESSAGE_SELECTOR)) {\n      return await this.getText(this.ERROR_MESSAGE_SELECTOR);\n    }\n    return '';\n  }\n\n  async isPaymentErrorDisplayed() {\n    return await this.isElementVisible(this.ERROR_MESSAGE_SELECTOR);\n  }\n\n  async completePayment(cardNumber, cardName, expiry, cvc, address) {\n    await this.enterPaymentDetails(cardNumber, cardName, expiry, cvc);\n    await this.enterBillingAddress(address);\n    await this.submitPayment();\n  }\n}\n\nmodule.exports = { PaymentPage };